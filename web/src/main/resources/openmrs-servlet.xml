<?xml version="1.0" encoding="UTF-8"?>
<!--

    This Source Code Form is subject to the terms of the Mozilla Public License,
    v. 2.0. If a copy of the MPL was not distributed with this file, You can
    obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under
    the terms of the Healthcare Disclaimer located at http://openmrs.org/license.

    Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS
    graphic logo is a trademark of OpenMRS Inc.

-->

<!-- Application context definition for Spring for the OpenMRS web layer.
-->
<!-- See /metadata/api/spring/applicationContext-service.xml for layer agnostic spring setup
-->

<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:p="http://www.springframework.org/schema/p"
	   xmlns:context="http://www.springframework.org/schema/context"
	   xmlns:jee="http://www.springframework.org/schema/jee"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       		http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
			http://www.springframework.org/schema/context
			http://www.springframework.org/schema/context/spring-context-3.0.xsd
			http://www.springframework.org/schema/jee
			http://www.springframework.org/schema/jee/spring-jee-3.0.xsd
			http://www.springframework.org/schema/tx
			http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
			http://www.springframework.org/schema/aop
           	http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
            http://www.springframework.org/schema/util
            http://www.springframework.org/schema/util/spring-util-3.0.xsd">
            	
	<!--  **************************  VIEW RESOLVER / CONTROLLERS  *************************  -->
	
	<bean id="jspViewResolver"
		class="org.springframework.web.servlet.view.InternalResourceViewResolver">
		<property name="viewClass" value="org.springframework.web.servlet.view.JstlView" />
		<property name="prefix" value="/WEB-INF/view/" />
		<property name="suffix" value=".jsp" />
	</bean>

	<bean id="multipartResolver"
		class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
		<!-- one of the properties available; the maximum file size in bytes -->
		<property name="maxUploadSize"><value>75000000</value></property>
	</bean>
	
	<bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
		<property name="mediaTypes">
			<map>
				<entry key="json" value="application/json" />
				<entry key="xml" value="application/xml" />
			</map>
		</property>
		<property name="defaultViews">
			<list>
				<bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
					<property name="extractValueFromSingleKeyModel" value="true" />
				</bean>
				<bean class="org.springframework.web.servlet.view.xml.MarshallingView">
           			<property name="marshaller" ref="xStreamMarshaller"/>
        		</bean>
			</list>
		</property>
	</bean>
	
	<bean id="xStreamMarshaller" class="org.springframework.oxm.xstream.XStreamMarshaller" />

	<bean id="xmlMarshallingHttpMessageConverter" class="org.springframework.http.converter.xml.MarshallingHttpMessageConverter">
 		<property name="marshaller" ref="xStreamMarshaller" />
		<property name="unmarshaller" ref="xStreamMarshaller" />
	</bean>
	
	<bean id="defaultMethodParamResolver" class="org.springframework.web.servlet.mvc.multiaction.ParameterMethodNameResolver">
		<property name="paramName"><value>method</value></property>
		<property name="defaultMethodName"><value>handleRequest</value></property>
	</bean>
	
	<!--  Exception handler mappings --> 
 		 
 	<bean class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver"> 
 		<property name="exceptionMappings"> 
 			<map> 
 				<entry key="org.openmrs.api.APIException" value="uncaughtException"/> 
 			</map> 
 		</property> 
 		<property name="order" value="100" /> 
 	</bean>
	
	<!-- So that controllers can use annotations like @Controller and @RequestMapping
-->
	<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping">
		<!-- makes annotations more important than default mappings -->
		<property name="order"><value>98</value></property>
		<!-- allows for locale changes on any annotation based page -->
		<property name="interceptors">
			<list>
				<ref bean="localeChangeInterceptor" />
				<ref bean="themeChangeInterceptor" />
				<!-- <ref bean="openSessionInViewInterceptor"/> -->
			</list>
		</property>
	</bean>

	<bean class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"/>

	<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
		<property name="webBindingInitializer">
			<bean class="org.openmrs.web.OpenmrsBindingInitializer"/>
		</property>
		<property name="messageConverters">
			<list>
				<bean class="org.springframework.http.converter.ByteArrayHttpMessageConverter" />
				<bean class="org.springframework.http.converter.StringHttpMessageConverter" />
				<bean class="org.springframework.http.converter.FormHttpMessageConverter" />
				<bean class="org.springframework.http.converter.xml.SourceHttpMessageConverter" />
				<bean class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter" />
				<ref bean="xmlMarshallingHttpMessageConverter" />
			</list>
		</property>
	</bean>
		
	<bean id="conversion-service" class="org.springframework.format.support.FormattingConversionServiceFactoryBean" />
	
	<!-- The default place to look for controllers that have annotations -->
	<context:component-scan base-package="org.openmrs.web.controller" />
	
	<bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
		<property name="interceptors">
			<list>
				<ref bean="localeChangeInterceptor" />
				<ref bean="themeChangeInterceptor" />
				<!-- <ref bean="openSessionInViewInterceptor"/> -->
			</list>
		</property>
		<property name="order"><value>99</value></property>
		<property name="mappings">
			<props>
				<prop key="admin/patients/patient.form">patientForm</prop>
				<prop key="admin/patients/mergePatients.form">mergePatientsForm</prop>
				
				<prop key="admin/patients/tribe.list">tribeList</prop>
								
				<prop key="admin/patients/patientIdentifierType.list">patientIdentifierTypeList</prop>
				<prop key="admin/patients/patientIdentifierType.form">patientIdentifierTypeForm</prop>
				
				<prop key="admin/person/person.form">personForm</prop>
				<prop key="admin/person/relationshipType.list">relationshipTypeList</prop>
				<prop key="admin/person/relationshipType.form">relationshipTypeForm</prop>
				<prop key="admin/person/relationshipTypeViews.form">relationshipTypeViewForm</prop>
				<prop key="admin/person/personAttributeType.form">personAttributeTypeForm</prop>
				<prop key="admin/person/addPerson.htm">addPerson</prop>

				<prop key="admin/observations/obs.form">obsForm</prop>
				<prop key="admin/observations/personObs.form">personObsForm</prop>

				<prop key="admin/users/role.list">roleList</prop>
				<prop key="admin/users/role.form">roleForm</prop>
				<prop key="admin/users/alert.list">alertList</prop>
				<prop key="admin/users/alert.form">alertForm</prop>
				<prop key="admin/users/privilege.list">privilegeList</prop>
				<prop key="admin/users/privilege.form">privilegeForm</prop>

				<prop key="admin/encounters/encounter.form">encounterForm</prop>
				<prop key="admin/encounters/encounterType.list">encounterTypeList</prop>
				<prop key="admin/encounters/encounterType.form">encounterTypeForm</prop>
				<prop key="admin/encounters/encounterDisplay.list">encounterDisplayController</prop>

				<prop key="admin/locations/location.list">locationList</prop>
				<prop key="admin/locations/location.form">locationForm</prop>

				<prop key="dictionary/concept.form">conceptForm</prop>
				<prop key="dictionary/conceptStats.form">conceptStatsForm</prop>
				<prop key="dictionary/concept.htm">conceptView</prop>

				<prop key="admin/concepts/conceptClass.list">conceptClassList</prop>
				<prop key="admin/concepts/conceptClass.form">conceptClassForm</prop>
				<prop key="admin/concepts/conceptSource.list">conceptSourceList</prop>
				<prop key="admin/concepts/conceptSource.form">conceptSourceForm</prop>
				<prop key="admin/concepts/conceptDrug.list">conceptDrugList</prop>
				<prop key="admin/concepts/conceptDrug.form">conceptDrugForm</prop>
				<prop key="admin/concepts/conceptDatatype.list">conceptDatatypeList</prop>
				<prop key="admin/concepts/conceptDatatype.form">conceptDatatypeForm</prop>
				<prop key="admin/concepts/conceptProposal.list">conceptProposalList</prop>
				<prop key="admin/concepts/conceptProposal.form">conceptProposalForm</prop>
				<prop key="admin/concepts/proposeConcept.form">proposeConceptForm</prop>
				<prop key="admin/hl7/hl7Source.list">hl7SourceList</prop>
				<prop key="admin/hl7/hl7Source.form">hl7SourceForm</prop>

				<prop key="options.form">optionsForm</prop>
				<prop key="personDashboard.form">personDashboardForm</prop>

				<prop key="admin/forms/formSchemaDesign.form">formSchemaDesignForm</prop>
				<prop key="admin/forms/formEdit.form">formEditForm</prop>
				<prop key="admin/forms/form.list">formList</prop>
				<prop key="admin/forms/field.form">fieldForm</prop>
				<prop key="admin/forms/field.list">fieldList</prop>
				<prop key="admin/forms/fieldType.form">fieldTypeForm</prop>
				<prop key="admin/forms/fieldType.list">fieldTypeList</prop>
				<prop key="admin/forms/auditField.form">auditFieldController</prop>
				
				<prop key="admin/scheduler/scheduler.list">schedulerListController</prop>
				<prop key="admin/scheduler/scheduler.form">schedulerFormController</prop>

				<prop key="remotecommunication/postHl7.form">postHl7FormController</prop>
				
				<prop key="admin/programs/program.list">programList</prop>
				<prop key="admin/programs/program.form">programForm</prop>
				<prop key="admin/programs/conversion.list">stateConversionList</prop>
				<prop key="admin/programs/conversion.form">stateConversionForm</prop>
				<prop key="admin/programs/workflow.form">workflowFormController</prop>
				<prop key="admin/programs/patientProgram.form">patientProgramFormController</prop>
				
				<prop key="admin/maintenance/globalProps.form">globalPropertyController</prop>
				<prop key="admin/maintenance/serverLog.form">serverLogController</prop>
				<!--<prop key="**/calendar.list">calendarController</prop>-->
				<prop key="admin/maintenance/implementationid.form">implementationIdFormController</prop>
				
				<prop key="admin/modules/module.list">moduleListController</prop>
				<prop key="admin/modules/moduleProperties.form">modulePropertiesFormController</prop>
				
				<prop key="forgotPassword.form">forgotPasswordForm</prop>

				<prop key="**/globalProperties.portlet">globalPropertyPortletController</prop>
				<prop key="**/addressLayout.portlet">addressLayoutPortletController</prop>
				<prop key="**/nameLayout.portlet">nameLayoutPortletController</prop>
				<prop key="**/patientPrograms.portlet">patientProgramsPortletController</prop>
				<prop key="**/personRelationships.portlet">personRelationshipsPortletController</prop>
				<prop key="**/patientEncounters.portlet">patientEncountersPortletController</prop>
				<prop key="**/patientVisits.portlet">patientVisitsPortletController</prop>
				<prop key="**/personFormEntry.portlet">personFormEntryPortletController</prop>
				<prop key="**/activeListAllergy.portlet">activeListPortletController</prop>
				<prop key="**/activeListProblem.portlet">activeListPortletController</prop>
				<!--<prop key="**/calendar.portlet">calendarPortletController</prop>-->

				<prop key="**/*.portlet">portletController</prop>
				<prop key="**/*.field">fieldGenController</prop>
				<prop key="**/*.htm">springController</prop>

				<prop key="admin/visits/visitType.list">visitTypeList</prop>
				<prop key="admin/visits/visitType.form">visitTypeForm</prop>
				<prop key="admin/visits/visitAttributeType.list">visitAttributeTypeList</prop>
				<prop key="admin/visits/visitAttributeType.form">visitAttributeTypeForm</prop>
				<prop key="admin/provider/providerAttributeType.list">providerAttributeTypeList</prop>
				<prop key="admin/provider/providerAttributeType.form">providerAttributeTypeForm</prop>				
			</props>
		</property>
	</bean>

	<bean id="fieldGenController" class="org.openmrs.web.controller.FieldGenController" />
	<bean id="portletController" class="org.openmrs.web.controller.PortletController" />
	<bean id="globalPropertyPortletController" class="org.openmrs.web.controller.GlobalPropertyPortletController" />
	<bean id="patientProgramsPortletController" class="org.openmrs.web.controller.PatientProgramsPortletController" />
	<bean id="personRelationshipsPortletController" class="org.openmrs.web.controller.PersonRelationshipsPortletController" />
	<bean id="patientEncountersPortletController" class="org.openmrs.web.controller.PatientEncountersPortletController" />
	<bean id="patientVisitsPortletController" class="org.openmrs.web.controller.PatientVisitsPortletController" />
	<bean id="personFormEntryPortletController" class="org.openmrs.web.controller.PersonFormEntryPortletController" />
	<bean id="addressLayoutPortletController" class="org.openmrs.web.controller.layout.AddressLayoutPortletController" />
	<bean id="nameLayoutPortletController" class="org.openmrs.web.controller.layout.NameLayoutPortletController" />
	<bean id="activeListPortletController" class="org.openmrs.web.controller.ActiveListPortletController" />
	<!--<bean id="calendarPortletController" class="org.openmrs.web.controller.CalendarPortletController"/>-->
	<bean id="springController" class="org.springframework.web.servlet.mvc.UrlFilenameViewController" />

	<!-- =============================== -->
	<!-- =====      Scheduler      ===== -->
	<!-- =============================== -->

	<!-- ** Scheduler List Controller ** -->
	<bean id="schedulerListController"
		class="org.openmrs.scheduler.web.controller.SchedulerListController">
		<property name="commandName"><value>taskList</value></property>
		<property name="formView"><value>/admin/scheduler/schedulerList</value></property>
		<property name="successView"><value>scheduler.list</value></property>
	</bean>
	
	<bean id="schedulerFormController" class="org.openmrs.scheduler.web.controller.SchedulerFormController">
		<property name="commandName"><value>task</value></property>
		<property name="formView"><value>/admin/scheduler/schedulerForm</value></property>
		<property name="successView"><value>scheduler.list</value></property>
		<property name="validator">
			<ref bean="taskValidator"/>
		</property>
	</bean>
	<!-- ** /Scheduler ** -->

	<!-- ================================ -->
	<!-- ====== Observation Sector ====== -->
	<!-- ================================ -->

	<bean id="obsForm" class="org.openmrs.web.controller.observation.ObsFormController">
		<property name="commandName"><value>obs</value></property>
		<property name="formView"><value>/admin/observations/obsForm</value></property>
		<property name="successView"><value>../encounters/encounter.form</value></property>
		<property name="validator">
			<ref bean="obsValidator" />
		</property>
	</bean>
	
	<bean id="personObsForm" class="org.openmrs.web.controller.observation.PersonObsFormController">
		<property name="commandName"><value>command</value></property>
		<property name="formView"><value>/admin/observations/personObsForm</value></property>
		<property name="successView"><value>personObs.form</value></property>
	</bean>

   	<!-- ====== /Observation Sector ====== -->

	<!--this is the optional method of declaring values in the constructor-->

	<!-- ** Patient ** -->
	<bean id="patientForm" class="org.openmrs.web.controller.patient.PatientFormController">
		<property name="commandName"><value>patient</value></property>
		<property name="formView"><value>/admin/patients/patientForm</value></property>
		<property name="successView"><value>patient.form</value></property>
	</bean>
	<!-- ** /Patient ** -->
		
	<bean id="tribeList" class="org.openmrs.web.controller.patient.TribeFormController">
		<property name="commandName"><value>tribeForm</value></property>
		<property name="formView"><value>/admin/patients/tribeList</value></property>
		<property name="successView"><value>tribe.list</value></property>
	</bean>

	<!-- **  Patient Identifier Type   ** -->
	<bean id="patientIdentifierTypeList"
		class="org.openmrs.web.controller.patient.PatientIdentifierTypeListController">
		<property name="commandName"><value>patientIdentifierTypeList</value></property>
		<property name="formView"><value>/admin/patients/patientIdentifierTypeList</value></property>
		<property name="successView"><value>patientIdentifierType.list</value></property>
	</bean>
	<bean id="patientIdentifierTypeForm"
		class="org.openmrs.web.controller.patient.PatientIdentifierTypeFormController">
		<property name="commandName"><value>patientIdentifierType</value></property>
		<property name="validator">
			<ref bean="patientIdentifierTypeValidator" />
		</property>
		<property name="formView"><value>/admin/patients/patientIdentifierTypeForm</value></property>
		<property name="successView"><value>patientIdentifierType.list</value></property>
	</bean>
	<!-- ** /Patient Identifier Type   ** -->

	<!-- ** Merge Patient ** -->
	<bean id="mergePatientsForm"
		class="org.openmrs.web.controller.patient.MergePatientsFormController">
		<property name="commandName"><value>patient1</value></property>
		<property name="formView"><value>/admin/patients/mergePatientsForm</value></property>
		<property name="successView"><value>mergePatients.form</value></property>
	</bean>
	<!-- ** /Merge Patient ** -->

	<!-- ====== /Patient Sector ====== -->


	<!-- ============================= -->
	<!-- ======  Person Sector  ====== -->
	<!-- ============================= -->
	<!-- ** Person ** -->
	<bean id="personForm" class="org.openmrs.web.controller.person.PersonFormController">
		<property name="commandName"><value>person</value></property>
		<property name="formView"><value>/admin/person/personForm</value></property>
		<property name="successView"><value>person.form</value></property>
		<property name="validator"><ref bean="personValidator" /></property>
	</bean>
	<!-- ** /Person ** -->
	
	<!-- **  Relationship Type   ** -->
	<bean id="relationshipTypeList"
		class="org.openmrs.web.controller.person.RelationshipTypeListController">
		<property name="commandName"><value>relationshipTypeList</value></property>
		<property name="formView"><value>/admin/person/relationshipTypeList</value></property>
		<property name="successView"><value>relationshipType.list</value></property>
	</bean>
	<bean id="relationshipTypeForm"
		class="org.openmrs.web.controller.person.RelationshipTypeFormController">
		<property name="commandName"><value>relationshipType</value></property>
		<property name="formView"><value>/admin/person/relationshipTypeForm</value></property>
		<property name="successView"><value>relationshipType.list</value></property>
	</bean>
	<bean id="relationshipTypeViewForm"
		class="org.openmrs.web.controller.person.RelationshipTypeViewFormController">
		<property name="commandName"><value>relationshipTypeList</value></property>
		<property name="formView"><value>/admin/person/relationshipTypeViewForm</value></property>
		<property name="successView"><value>relationshipType.list</value></property>
	</bean>
	<!-- ** /Relationship Type   ** -->

	<bean id="personAttributeTypeForm"
		class="org.openmrs.web.controller.person.PersonAttributeTypeFormController">
		<property name="commandName"><value>personAttributeType</value></property>
		<property name="formView"><value>/admin/person/personAttributeTypeForm</value></property>
		<property name="successView"><value>personAttributeType.list</value></property>
		<property name="validator"><ref bean="personAttributeTypeValidator" /></property>
	</bean>
	<!-- ** /PersonAttribute Type   ** -->

	<!-- ** Add Person ** -->
	<!--  Used for finding duplicate patients / users -->
	<bean id="addPerson" class="org.openmrs.web.controller.person.AddPersonController">
		<property name="commandName"><value>people</value></property>
		<property name="formView"><value>/admin/person/addPerson</value></property>
		<property name="successView"><value>admin/person/newPerson.form</value></property>
	</bean>
	<!-- ** /Add Person ** -->

	<!-- ====== /Person Sector ====== -->


	<!-- =========================== -->
	<!-- ======  User Sector  ====== -->
	<!-- =========================== -->

	<!-- ** Role  ** -->
	<bean id="roleList" class="org.openmrs.web.controller.user.RoleListController">
		<property name="commandName"><value>roleList</value></property>
		<property name="formView"><value>/admin/users/roleList</value></property>
		<property name="successView"><value>role.list</value></property>
	</bean>

	<!--  Form Controller for the add/edit role page -->
	<bean id="roleForm" class="org.openmrs.web.controller.user.RoleFormController">
		<property name="commandName"><value>role</value></property>
		<property name="validator">
			<ref bean="roleValidator" />
		</property>
		<property name="formView"><value>/admin/users/roleForm</value></property>
		<property name="successView"><value>role.list</value></property>
	</bean>
	<!--  ** /Role ** -->
	<!-- ** Privilege  ** -->
	<bean id="privilegeList" class="org.openmrs.web.controller.user.PrivilegeListController">
		<property name="commandName"><value>privilegeList</value></property>
		<property name="formView"><value>/admin/users/privilegeList</value></property>
		<property name="successView"><value>privilege.list</value></property>
	</bean>

	<!--  Form Controller for the add/edit privilege page -->
	<bean id="privilegeForm" class="org.openmrs.web.controller.user.PrivilegeFormController">
		<property name="commandName"><value>privilege</value></property>
		<property name="validator">
			<ref bean="privilegeValidator" />
		</property>
		<property name="formView"><value>/admin/users/privilegeForm</value></property>
		<property name="successView"><value>privilege.list</value></property>
	</bean>
	<!--  ** /Privilege ** -->

	<!-- ** Alert  ** -->
	<bean id="alertList" class="org.openmrs.notification.web.controller.AlertListController">
		<property name="commandName"><value>alertList</value></property>
		<property name="formView"><value>/admin/users/alertList</value></property>
		<property name="successView"><value>alert.list</value></property>
	</bean>

	<bean id="alertForm" class="org.openmrs.notification.web.controller.AlertFormController">
		<property name="commandName"><value>alert</value></property>
		<property name="formView"><value>/admin/users/alertForm</value></property>
		<property name="successView"><value>alert.list</value></property>
	</bean>
	<!--  ** /Alert ** -->

	<!-- ====== /User Sector ====== -->

	<!-- ============================ -->
	<!-- ===== Encounter Sector ===== -->
	<!-- ============================ -->
	<!-- ** Encounter      ** -->
	<bean id="encounterForm" class="org.openmrs.web.controller.encounter.EncounterFormController">
		<property name="commandName"><value>encounter</value></property>
		<property name="formView"><value>/admin/encounters/encounterForm</value></property>
		<property name="successView"><value>encounter.form</value></property>
	</bean>
	<!-- ** /Encounter     ** -->

	<!-- ** Encounter Type ** -->
	<bean id="encounterTypeList"
		class="org.openmrs.web.controller.encounter.EncounterTypeListController">
		<property name="commandName"><value>encounterTypeList</value></property>
		<property name="formView"><value>/admin/encounters/encounterTypeList</value></property>
		<property name="successView"><value>encounterType.list</value></property>
	</bean>

	<!--  Form Controller for the add/edit encounter types page -->
	<bean id="encounterTypeForm"
		class="org.openmrs.web.controller.encounter.EncounterTypeFormController">
		<property name="commandName"><value>encounterType</value></property>
		<property name="validator">
			<ref bean="encounterTypeValidator" />
		</property>
		<property name="formView"><value>/admin/encounters/encounterTypeForm</value></property>
		<property name="successView"><value>encounterType.list</value></property>
	</bean>
	<!-- ** /Encounter Type ** -->
	<!-- ** Location ** -->
	<bean id="locationList" class="org.openmrs.web.controller.encounter.LocationListController">
		<property name="commandName"><value>locationList</value></property>
		<property name="formView"><value>/admin/locations/locationList</value></property>
		<property name="successView"><value>location.list</value></property>
	</bean>

	<!--  Form Controller for the add/edit encounter types page -->
	<bean id="locationForm" class="org.openmrs.web.controller.encounter.LocationFormController">
		<property name="commandName"><value>location</value></property>
		<property name="validator">
			<ref bean="locationValidator" />
		</property>
		<property name="formView"><value>/admin/locations/locationForm</value></property>
		<property name="successView"><value>location.list</value></property>
	</bean>
	<!-- ** /Location ** -->

	<bean id="encounterDisplayController"
		class="org.openmrs.web.controller.encounter.EncounterDisplayController" />
	<!-- ============================ -->

	<!-- ============================ -->
	<!-- =====  Concept Sector  ===== -->
	<!-- ============================ -->
	<!-- ** Concept ** -->
	<bean id="conceptFormValidator" class="org.openmrs.web.controller.ConceptFormValidator" />
	<bean id="conceptForm" class="org.openmrs.web.controller.ConceptFormController">
		<property name="commandName"><value>command</value></property>
		<property name="validator">
			<ref bean="conceptFormValidator" />
		</property>
		<property name="formView"><value>/dictionary/conceptForm</value></property>
		<property name="successView"><value>concept.form</value></property>
	</bean>
	<bean id="conceptStatsForm" class="org.openmrs.web.controller.ConceptStatsFormController">
		<property name="commandName"><value>concept</value></property>
		<property name="formView"><value>/dictionary/conceptStatsForm</value></property>
		<property name="successView"><value>conceptStats.form</value></property>
	</bean>
	<bean id="conceptView" class="org.openmrs.web.controller.ConceptFormController">
		<property name="commandName"><value>command</value></property>
		<property name="formView"><value>/dictionary/concept</value></property>
		<property name="successView"><value>concept.htm</value></property>
	</bean>
	<!-- ** /Concept ** -->
	<!-- ** Concept Drug ** -->
	<bean id="conceptDrugList"
		class="org.openmrs.web.controller.concept.ConceptDrugListController">
		<property name="commandName"><value>conceptDrugList</value></property>
		<property name="formView"><value>/admin/concepts/conceptDrugList</value></property>
		<property name="successView"><value>conceptDrug.list</value></property>
	</bean>

	<bean id="conceptDrugForm"
		class="org.openmrs.web.controller.concept.ConceptDrugFormController">
		<property name="commandName"><value>drug</value></property>
		<property name="validator">
			<ref bean="conceptDrugValidator" />
		</property>
		<property name="formView"><value>/admin/concepts/conceptDrugForm</value></property>
		<property name="successView"><value>conceptDrug.list</value></property>
	</bean>
	<!--  ** /Concept Drug ** -->
	<!-- ** Concept Class ** -->
	<bean id="conceptClassList"
		class="org.openmrs.web.controller.concept.ConceptClassListController">
		<property name="commandName"><value>conceptClassList</value></property>
		<property name="formView"><value>/admin/concepts/conceptClassList</value></property>
		<property name="successView"><value>conceptClass.list</value></property>
	</bean>

	<!--  Form Controller for the add/edit concept types page -->
	<bean id="conceptClassForm"
		class="org.openmrs.web.controller.concept.ConceptClassFormController">
		<property name="commandName"><value>conceptClass</value></property>
		<property name="validator">
			<ref bean="conceptClassValidator" />
		</property>
		<property name="formView"><value>/admin/concepts/conceptClassForm</value></property>
		<property name="successView"><value>conceptClass.list</value></property>
	</bean>
	<!--  ** /Concept Class ** -->
	<!--  ** Concept Datatype ** -->
	<bean id="conceptDatatypeList"
		class="org.openmrs.web.controller.concept.ConceptDatatypeListController">
		<property name="commandName"><value>conceptDatatypeList</value></property>
		<property name="formView"><value>/admin/concepts/conceptDatatypeList</value></property>
		<property name="successView"><value>conceptDatatype.list</value></property>
	</bean>

	<!--  Form Controller for the add/edit concept types page -->
	<bean id="conceptDatatypeForm"
		class="org.openmrs.web.controller.concept.ConceptDatatypeFormController">
		<property name="commandName"><value>conceptDatatype</value></property>
		<property name="validator">
			<ref bean="conceptDatatypeValidator" />
		</property>
		<property name="formView"><value>/admin/concepts/conceptDatatypeForm</value></property>
		<property name="successView"><value>conceptDatatype.list</value></property>
	</bean>
	<!--  ** /Concept Datatype ** -->
	<!--  ** Concept Proposal ** -->
	<bean id="conceptProposalList"
		class="org.openmrs.web.controller.concept.ConceptProposalListController">
		<property name="commandName"><value>conceptProposalMap</value></property>
		<property name="formView"><value>/admin/concepts/conceptProposalList</value></property>
		<property name="successView"><value>conceptProposal.list</value></property>
	</bean>

	<bean id="conceptProposalForm"
		class="org.openmrs.web.controller.concept.ConceptProposalFormController">
		<property name="commandName"><value>conceptProposal</value></property>
		<property name="formView"><value>/admin/concepts/conceptProposalForm</value></property>
		<property name="successView"><value>conceptProposal.list</value></property>
	</bean>

	<bean id="proposeConceptForm"
		class="org.openmrs.web.controller.concept.ProposeConceptFormController">
		<property name="commandName"><value>conceptProposal</value></property>
		<property name="formView"><value>/admin/concepts/proposeConceptForm</value></property>
		<property name="successView"><value>conceptProposal.list</value></property>
	</bean>
	<!--  ** /Concept Proposal ** -->
	<!-- ** Concept Source ** -->
	<bean id="conceptSourceList"
		class="org.openmrs.web.controller.concept.ConceptSourceListController">
		<property name="commandName"><value>conceptSourceList</value></property>
		<property name="formView"><value>/admin/concepts/conceptSourceList</value></property>
		<property name="successView"><value>conceptSource.list</value></property>
	</bean>

	<!--  Form Controller for the add/edit concept types page -->
	<bean id="conceptSourceForm"
		class="org.openmrs.web.controller.concept.ConceptSourceFormController">
		<property name="commandName"><value>conceptSource</value></property>
		<property name="validator">
			<ref bean="conceptSourceValidator" />
		</property>
		<property name="formView"><value>/admin/concepts/conceptSourceForm</value></property>
		<property name="successView"><value>conceptSource.list</value></property>
	</bean>
	<!--  ** /Concept Source ** -->	

	<!-- ============================ -->
	<!-- ===== Form Sector ===== -->
	<!-- ============================ -->

	<!-- ** Form ** -->
	<bean id="formList" class="org.openmrs.web.controller.form.FormListController">
		<property name="commandName"><value>formList</value></property>
		<property name="formView"><value>/admin/forms/formList</value></property>
		<property name="successView"><value>form.list</value></property>
	</bean>

	<bean id="formSchemaDesignForm" class="org.openmrs.web.controller.form.FormFormController">
		<property name="commandName"><value>form</value></property>
		<property name="formView"><value>/admin/forms/formSchemaDesignForm</value></property>
		<property name="successView"><value>form.list</value></property>
	</bean>

	<bean id="formEditForm" class="org.openmrs.web.controller.form.FormFormController">
		<property name="commandName"><value>form</value></property>
		<property name="formView"><value>/admin/forms/formEditForm</value></property>
		<property name="validator">
			<ref bean="formEditValidator" />
		</property>
		<property name="successView"><value>form.list</value></property>
	</bean>
	<!-- ** /Form ** -->

	<!-- ** Field  ** -->
	<bean id="fieldList" class="org.openmrs.web.controller.form.FieldListController">
		<property name="commandName"><value>fieldList</value></property>
		<property name="formView"><value>/admin/forms/fieldList</value></property>
		<property name="successView"><value>field.list</value></property>
	</bean>

	<bean id="fieldForm" class="org.openmrs.web.controller.form.FieldFormController">
		<property name="commandName"><value>field</value></property>
		<property name="validator">
			<ref bean="fieldValidator" />
		</property>
		<property name="formView"><value>/admin/forms/fieldForm</value></property>
		<property name="successView"><value>field.list</value></property>
	</bean>
	<bean id="auditFieldController" class="org.openmrs.web.controller.form.AuditFieldController">
		<property name="formView"><value>/admin/forms/auditFieldForm</value></property>
		<property name="successView"><value>auditField.form</value></property>
	</bean>
	<!-- ** /Field  ** -->


	<!-- ** Field Type ** -->
	<bean id="fieldTypeList" class="org.openmrs.web.controller.form.FieldTypeListController">
		<property name="commandName"><value>fieldTypeList</value></property>
		<property name="formView"><value>/admin/forms/fieldTypeList</value></property>
		<property name="successView"><value>fieldType.list</value></property>
	</bean>

	<!--  Form Controller for the add/edit forms page -->
	<bean id="fieldTypeForm" class="org.openmrs.web.controller.form.FieldTypeFormController">
		<property name="commandName"><value>fieldType</value></property>
		<property name="validator">
			<ref bean="fieldTypeValidator" />
		</property>
		<property name="formView"><value>/admin/forms/fieldTypeForm</value></property>
		<property name="successView"><value>fieldType.list</value></property>
	</bean>
	<!-- ** /Field Type ** -->
	<!-- ============================ -->



	<!-- ======================================== -->
	<!-- =====    Programs and Workflows    ===== -->
	<!-- ======================================== -->
	<bean id="programList" class="org.openmrs.web.controller.program.ProgramListController">
		<property name="commandName"><value>programList</value></property>
		<property name="formView"><value>/admin/programs/programList</value></property>
		<property name="successView"><value>program.list</value></property>
	</bean>
	<bean id="programForm" class="org.openmrs.web.controller.program.ProgramFormController">
		<property name="commandName"><value>program</value></property>
		<property name="validator">
			<ref bean="programValidator" />
		</property>
		<property name="formView"><value>/admin/programs/programForm</value></property>
		<property name="successView"><value>program.list</value></property>
	</bean>
	<bean id="patientProgramFormController"
		class="org.springframework.web.servlet.mvc.multiaction.MultiActionController">
		<property name="methodNameResolver">
			<ref bean="defaultMethodParamResolver" />
		</property>
		<property name="delegate">
			<bean class="org.openmrs.web.controller.program.PatientProgramFormController" />
		</property>
	</bean>
	<bean id="workflowFormController"
		class="org.openmrs.web.controller.program.WorkflowFormController">
		<property name="commandName"><value>workflow</value></property>
		<property name="formView"><value>/admin/programs/workflowForm</value></property>
		<property name="successView"><value>program.list</value></property>
	</bean>

	<bean id="stateConversionList"
		class="org.openmrs.web.controller.program.StateConversionListController">
		<property name="commandName"><value>stateConversionList</value></property>
		<property name="formView"><value>/admin/programs/conversionList</value></property>
		<property name="successView"><value>conversion.list</value></property>
	</bean>
	<bean id="stateConversionForm"
		class="org.openmrs.web.controller.program.StateConversionFormController">
		<property name="commandName"><value>conversion</value></property>
		<property name="validator">
			<ref bean="stateConversionValidator" />
		</property>
		<property name="formView"><value>/admin/programs/conversionForm</value></property>
		<property name="successView"><value>conversion.list</value></property>
	</bean>

	<!-- ======================================== -->

	<!-- ========================================= -->
	<!-- =====      Calendar/Scheduling      ===== -->
	<!-- ========================================= -->

	<!--
		
		<bean id="calendarController" class="org.openmrs.web.controller.calendar.CalendarController">
		<property name="commandName"><value>eventList</value></property>
		<property name="formView"><value>/calendar/calendar</value></property>
		<property name="successView"><value>calendar.list</value></property>
		</bean>
		
	-->

	<!-- ================================ -->
	<!-- ======  hl7Source Sector  ====== -->
	<!-- ================================ -->

	<bean id="hl7SourceList" class="org.openmrs.web.controller.hl7.Hl7SourceListController">
		<property name="commandName"><value>hl7SourceList</value></property>
		<property name="formView"><value>/admin/hl7/hl7SourceList</value></property>
		<property name="successView"><value>hl7Source.list</value></property>
		
	</bean>

	<bean id="hl7SourceForm"
		class="org.openmrs.web.controller.hl7.HL7SourceFormController">
		<property name="commandName"><value>hl7Source</value></property>
		<property name="validator">
			<ref bean="hl7SourceValidator" />
		</property>
		<property name="formView"><value>/admin/hl7/hl7SourceForm</value></property>
		<property name="successView"><value>hl7Source.list</value></property>
	</bean>
   	<!-- ====== /hl7Source Section ====== -->


	<!-- =========================== -->
	<!-- =====      Other      ===== -->
	<!-- =========================== -->
        
	<bean id="postHl7FormController" class="org.openmrs.web.controller.remotecommunication.PostHl7Controller">
		<property name="formView"><value>/remotecommunication/postHl7Form</value></property>
	</bean>
	<bean id="optionsForm" class="org.openmrs.web.controller.OptionsFormController">
		<property name="commandName"><value>opts</value></property>
		<property name="commandClass"><value>org.openmrs.web.OptionsForm</value></property>
		<property name="formView"><value>/optionsForm</value></property>
		<property name="successView"><value>options.form</value></property>
	</bean>
	<bean id="personDashboardForm"
		class="org.openmrs.web.controller.person.PersonDashboardController">
		<property name="commandName"><value>person</value></property>
		<property name="formView"><value>/personDashboardForm</value></property>
		<property name="successView"><value>personDashboard.form</value></property>
	</bean>
	<bean id="globalPropertyController"
		class="org.openmrs.web.controller.maintenance.GlobalPropertyController">
		<property name="commandName"><value>globalProps</value></property>
		<property name="formView"><value>/admin/maintenance/globalPropsForm</value></property>
		<property name="successView"><value>globalProps.form</value></property>
	</bean>
	<bean id="serverLogController"
		class="org.openmrs.web.controller.maintenance.ServerLogController">
		<property name="commandName"><value>logLines</value></property>
		<property name="formView"><value>/admin/maintenance/serverLog</value></property>
		<property name="successView"><value>serverLog.form</value></property>
	</bean>
	<bean id="implementationIdFormController"
		class="org.openmrs.web.controller.maintenance.ImplementationIdFormController">
		<property name="commandName"><value>implId</value></property>
		<property name="formView"><value>/admin/maintenance/implementationIdForm</value></property>
		<property name="successView"><value>implementationid.form</value></property>
	</bean>
	
	<bean id="moduleListController"
		class="org.openmrs.module.web.controller.ModuleListController">
		<property name="commandName"><value>moduleList</value></property>
		<property name="formView"><value>/admin/modules/moduleList</value></property>
		<property name="successView"><value>module.list</value></property>
	</bean>
	<bean id="modulePropertiesFormController"
		class="org.openmrs.module.web.controller.ModulePropertiesFormController">
		<property name="commandName"><value>moduleProperties</value></property>
		<property name="formView"><value>/admin/modules/modulePropertiesForm</value></property>
		<property name="successView"><value>moduleProperties.form</value></property>
	</bean>
	
	<bean id="forgotPasswordForm"
		class="org.openmrs.web.controller.ForgotPasswordFormController">
		<property name="commandName"><value>forgotPassword</value></property>
		<property name="formView"><value>/forgotPasswordForm</value></property>
		<property name="successView"><value>forgotPassword.form</value></property>
	</bean>

	<!-- ** Visit Type ** -->
	<bean id="visitTypeList"
		class="org.openmrs.web.controller.visit.VisitTypeListController">
		<property name="commandName"><value>visitTypeList</value></property>
		<property name="formView"><value>/admin/visits/visitTypeList</value></property>
		<property name="successView"><value>visitType.list</value></property>
	</bean>

	<!--  Form Controller for the add/edit visit types page -->
	<bean id="visitTypeForm"
		class="org.openmrs.web.controller.visit.VisitTypeFormController">
		<property name="commandName"><value>visitType</value></property>
		<property name="validator">
			<ref bean="visitTypeValidator" />
		</property>
		<property name="formView"><value>/admin/visits/visitTypeForm</value></property>
		<property name="successView"><value>visitType.list</value></property>
	</bean>
	<!-- ** /Visit Type ** -->

	<!-- ======================================== -->

	<!-- ** Visit Attribute Type ** -->
	<bean id="visitAttributeTypeList"
		class="org.openmrs.web.controller.visit.VisitAttributeTypeListController">
		<property name="commandName"><value>visitAttributeTypeList</value></property>
		<property name="formView"><value>/admin/visits/visitAttributeTypeList</value></property>
		<property name="successView"><value>visitAttributeType.list</value></property>
	</bean>

	<!--  Form Controller for the add/edit visit attribute types page -->
	<bean id="visitAttributeTypeForm"
		class="org.openmrs.web.controller.visit.VisitAttributeTypeFormController">
		<property name="commandName"><value>visitAttributeType</value></property>
		<property name="validator">
			<ref bean="visitAttributeTypeValidator" />
		</property>
		<property name="formView"><value>/admin/visits/visitAttributeTypeForm</value></property>
		<property name="successView"><value>visitAttributeType.list</value></property>
	</bean>
	<!-- ** /Visit Attribute Type ** -->

	<!-- ** Provider Attribute Type ** -->
	<bean id="providerAttributeTypeList"
		class="org.openmrs.web.controller.provider.ProviderAttributeTypeListController">
		<property name="commandName"><value>providerAttributeTypeList</value></property>
		<property name="formView"><value>/admin/provider/providerAttributeTypeList</value></property>
		<property name="successView"><value>providerAttributeType.list</value></property>
	</bean>
	<!--  Form Controller for the add/edit provider attribute types page -->
	<bean id="providerAttributeTypeForm"
		class="org.openmrs.web.controller.provider.ProviderAttributeTypeFormController">
		<property name="commandName"><value>providerAttributeType</value></property>
		<property name="validator">
			<ref bean="providerAttributeTypeValidator" />
		</property>
		<property name="formView"><value>/admin/provider/providerAttributeTypeForm</value></property>
		<property name="successView"><value>providerAttributeType.list</value></property>
	</bean>	
	<!-- ** /Provider Attribute Type ** -->

	<!-- ======================================== -->


	<!-- Use an alias to the messageSourceService (defined in applicationContext-service.xml)
		to override the application MessageSource, which must be named "messageSource".
	-->	
	<alias name="messageSourceServiceTarget" alias="messageSource"/>
	
	<bean id="parentTheme" class="org.openmrs.web.StaticThemeSource">
		<property name="themeName"><value>/themes/defaults</value></property>
	</bean>
	
	<!-- Specify the default OpenMRS look and feel. -->
	<bean id="themeSource"
		class="org.springframework.ui.context.support.ResourceBundleThemeSource">
		<property name="parentThemeSource"><ref bean="parentTheme"/></property>
		<property name="basenamePrefix">
			<value>/themes/</value>
		</property>
	</bean>
	
	<bean id="themeResolver" class="org.openmrs.web.OpenmrsCookieThemeResolver">
		<property name="defaultThemeName"><value>green</value></property>
	</bean>
	
	<bean id="themeChangeInterceptor"
		class="org.springframework.web.servlet.theme.ThemeChangeInterceptor">
		<property name="paramName"><value>theme</value></property>
	</bean>
	
	<bean id="localeResolver" class="org.openmrs.web.OpenmrsCookieLocaleResolver" />

	<bean id="localeChangeInterceptor"
		class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
		<property name="paramName"><value>lang</value></property>
	</bean>

	<!-- 
		<bean name="openSessionInViewInterceptor" class="org.springframework.orm.hibernate3.support.OpenSessionInViewInterceptor">
		<property name="sessionFactory"><ref bean="sessionFactory"/></property>
		</bean>
	-->

	<!--  **************************  FIELDGEN HANDLER FACTORY CONFIGURATION  *************************  -->

	<!-- Configuration for fieldGen device
		USAGE: You can use the FieldGen tag library to automatically generate the html for various
		fields in an object.  It uses reflection to figure out what class the field is, and
		then uses the appropriate handler.  Thus, you need to register handlers that you create
		below.
		EXAMPLE: For example, fieldGen taglib is used by report object/element admin interface.  All
		report objects extend AbstractReportObject, but since it is extensible, we cannot know
		what the form should look like (what fields ahead of time) - instead a form is generated
		that has the fields contained within the abstract superclass, and then the view iterates
		through the declared fields in the subclass, and uses the fieldGen tag to render the html
		for those fields.(CALLEN)
	-->

	<bean id="fieldGenHandlerFactory"
		class="org.openmrs.web.taglib.fieldgen.FieldGenHandlerFactory">
		<property name="handlers">
			<props>
				<prop key="java.lang.String">org.openmrs.web.taglib.fieldgen.StringHandler</prop>
				<prop key="org.openmrs.Patient">
					org.openmrs.web.taglib.fieldgen.PatientHandler
				</prop>
				<prop key="org.openmrs.Person">
					org.openmrs.web.taglib.fieldgen.PersonHandler
				</prop>
				<prop key="org.openmrs.Concept">
					org.openmrs.web.taglib.fieldgen.ConceptHandler
				</prop>
				<prop key="org.openmrs.Encounter">
					org.openmrs.web.taglib.fieldgen.EncounterHandler
				</prop>
				<prop key="org.openmrs.User">org.openmrs.web.taglib.fieldgen.UserHandler</prop>
				<prop key="org.openmrs.Drug">org.openmrs.web.taglib.fieldgen.DrugHandler</prop>
				<prop key="org.openmrs.Location">
					org.openmrs.web.taglib.fieldgen.LocationHandler
				</prop>
				<prop key="org.openmrs.ProgramWorkflow">
					org.openmrs.web.taglib.fieldgen.ProgramWorkflowHandler
				</prop>
				<prop key="org.openmrs.Patient.exitReason">
					org.openmrs.web.taglib.fieldgen.GenericReasonHandler
				</prop>
				<prop key="java.util.Date">org.openmrs.web.taglib.fieldgen.DateHandler</prop>
				<prop key="org.openmrs.util.AttributableDate">org.openmrs.web.taglib.fieldgen.DateHandler</prop>
				<prop key="org.openmrs.Provider">
					org.openmrs.web.taglib.fieldgen.ProviderHandler
				</prop>
			</props>
		</property>
	</bean>


	<!-- NAME LAYOUT SUPPORT -->
	
	<!-- specialTokens ordered so that the subset string 'familyName' is after 'familyName*'
-->
	<bean id="nameSupport" class="org.openmrs.layout.name.NameSupport">
		<property name="defaultLayoutFormat"><value>short</value></property>
		<property name="layoutTemplates">
			<list>
				<ref bean="nameTemplateSpain" />
				<ref bean="nameTemplateLatinAmerica" />
				<ref bean="nameTemplateGivenFamily" />
				<ref bean="nameTemplateShort" />
				<ref bean="nameTemplateLong" />
			</list>
		</property>
		<property name="specialTokens">
			<list>
				<value>prefix</value>
				<value>givenName</value>
				<value>middleName</value>
				<value>familyNamePrefix</value>
				<value>familyNameSuffix</value>
				<value>familyName2</value>
				<value>familyName</value>
				<value>degree</value>
			</list>
		</property>
	</bean>
	
	<bean id="nameTemplateSpain" class="org.openmrs.layout.name.NameTemplate">
		<property name="displayName"><value>Formato de Nombres en Espana</value></property>
		<property name="codeName"><value>spain</value></property>
		<property name="nameMappings">
			<props>
				<prop key="givenName">PersonName.givenName</prop>
				<prop key="familyName">PersonName.familyName</prop>
				<prop key="familyName2">PersonName.familyName2</prop>
			</props>
		</property>
		<property name="sizeMappings">
			<props>
				<prop key="givenName">30</prop>
				<prop key="familyName">25</prop>
				<prop key="familyName2">25</prop>
			</props>
		</property>
		<property name="lineByLineFormat">
			<list>
				<value>givenName</value>
				<value>familyName</value>
				<value>familyName2</value>
			</list>
		</property>
	</bean>
	
	<bean id="nameTemplateLatinAmerica" class="org.openmrs.layout.name.NameTemplate">
		<property name="displayName"><value>Formato de Nombres en Latino America</value></property>
		<property name="codeName"><value>latinamerica</value></property>
		<property name="nameMappings">
			<props>
				<prop key="givenName">PersonName.firstName</prop>
				<prop key="middleName">PersonName.secondName</prop>
				<prop key="familyName">PersonName.familyName1</prop>
				<prop key="familyName2">PersonName.familyName2</prop>
			</props>
		</property>
		<property name="sizeMappings">
			<props>
				<prop key="givenName">30</prop>
				<prop key="middleName">30</prop>
				<prop key="familyName">30</prop>
				<prop key="familyName2">30</prop>
			</props>
		</property>
		<property name="lineByLineFormat">
			<list>
				<value>givenName</value>
				<value>middleName</value>
				<value>familyName</value>
				<value>familyName2</value>
			</list>
		</property>
	</bean>
	
	<bean id="nameTemplateGivenFamily" class="org.openmrs.layout.name.NameTemplate">
        <property name="displayName"><value>&quot;Given Family&quot; Format</value></property>
        <property name="codeName"><value>givenfamily</value></property>
        <property name="nameMappings">
                <props>
                        <prop key="givenName">PersonName.givenName</prop>
                        <prop key="familyName">PersonName.familyName</prop>
                </props>
        </property>
        <property name="sizeMappings">
                <props>
                        <prop key="givenName">30</prop>
                        <prop key="familyName">30</prop>
                </props>
        </property>
        <property name="lineByLineFormat">
                <list>
                        <value>givenName</value>
                        <value>familyName</value>
                </list>
        </property>
    </bean>

	<bean id="nameTemplateShort" class="org.openmrs.layout.name.NameTemplate">
		<property name="displayName"><value>Short Name Format</value></property>
		<property name="codeName"><value>short</value></property>
		<property name="nameMappings">
			<props>
				<prop key="givenName">PersonName.givenName</prop>
				<prop key="middleName">PersonName.middleName</prop>
				<prop key="familyName">PersonName.familyName</prop>
			</props>
		</property>
		<property name="sizeMappings">
			<props>
				<prop key="givenName">30</prop>
				<prop key="middleName">30</prop>
				<prop key="familyName">30</prop>
			</props>
		</property>
		<property name="lineByLineFormat">
			<list>
				<value>givenName</value>
				<value>middleName</value>
				<value>familyName</value>
			</list>
		</property>
	</bean>
	
	<bean id="nameTemplateLong" class="org.openmrs.layout.name.NameTemplate">
		<property name="displayName"><value>Long Name Format</value></property>
		<property name="codeName"><value>long</value></property>
		<property name="nameMappings">
			<props>
				<prop key="prefix">PersonName.prefix</prop>
				<prop key="givenName">PersonName.givenName</prop>
				<prop key="middleName">PersonName.middleName</prop>
				<prop key="familyNamePrefix">PersonName.familyNamePrefix</prop>
				<prop key="familyName">PersonName.familyName</prop>
				<prop key="familyName2">PersonName.familyName2</prop>
				<prop key="familyNameSuffix">PersonName.familyNameSuffix</prop>
				<prop key="degree">PersonName.degree</prop>
			</props>
		</property>
		<property name="sizeMappings">
			<props>
				<prop key="prefix">5</prop>
				<prop key="givenName">30</prop>
				<prop key="middleName">30</prop>
				<prop key="familyNamePrefix">8</prop>
				<prop key="familyName">25</prop>
				<prop key="familyName2">25</prop>
				<prop key="familyNameSuffix">8</prop>
				<prop key="degree">5</prop>
			</props>
		</property>
		<property name="lineByLineFormat">
			<list>
				<value>prefix</value>
				<value>givenName</value>
				<value>middleName</value>
				<value>familyNamePrefix familyName familyName2 familyNameSuffix</value>
				<value>degree</value>
			</list>
		</property>
	</bean>
	
	<bean id="nameSupportWeb" class="org.openmrs.layout.web.name.NameSupport" parent="nameSupport">
			<property name="layoutTemplates">
			<list>
				<ref bean="nameTemplateSpainWeb" />
				<ref bean="nameTemplateLatinAmericaWeb" />
				<ref bean="nameTemplateGivenFamilyWeb" />
				<ref bean="nameTemplateShortWeb" />
				<ref bean="nameTemplateLongWeb" />
			</list>
		</property>
	</bean>
	
	<bean id="nameTemplateSpainWeb" class="org.openmrs.layout.web.name.NameTemplate" parent="nameTemplateSpain" />
	
	<bean id="nameTemplateLatinAmericaWeb" class="org.openmrs.layout.web.name.NameTemplate" parent="nameTemplateLatinAmerica" />
	
	<bean id="nameTemplateGivenFamilyWeb" class="org.openmrs.layout.web.name.NameTemplate" parent="nameTemplateGivenFamily" />
	
	<bean id="nameTemplateShortWeb" class="org.openmrs.layout.web.name.NameTemplate" parent="nameTemplateShort" />
	
	<bean id="nameTemplateLongWeb" class="org.openmrs.layout.web.name.NameTemplate" parent="nameTemplateLong" />

    <!--  COMPLEX OBS HANDLER SECTION -->
    <bean parent="obsServiceTarget" >
        <property name="handlers">
            <map>
                <entry>
                    <key><value>BinaryDataHandler</value></key>
                    <bean class="org.openmrs.web.controller.observation.handler.WebBinaryDataHandler"/>
                </entry>
                <entry>
                    <key><value>BinaryStreamHandler</value></key>
                    <bean class="org.openmrs.web.controller.observation.handler.WebBinaryStreamHandler"/>
                </entry>
                <entry>
                    <key><value>ImageHandler</value></key>
                    <bean class="org.openmrs.web.controller.observation.handler.WebImageHandler"/>
                </entry>
                <entry>
                    <key><value>TextHandler</value></key>
                    <bean class="org.openmrs.web.controller.observation.handler.WebTextHandler"/>
                </entry>
				<entry>
					<key><value>MediaHandler</value></key>
					<bean class="org.openmrs.web.controller.observation.handler.WebMediaHandler"/>
				</entry>
            </map>
        </property>
    </bean>

	<!-- Add global property listeners -->
	<bean id="webEventListeners" parent="openmrsEventListeners">
	    <property name="globalPropertyListeners">
	        <list value-type="org.openmrs.api.GlobalPropertyListener">
	            <bean class="org.openmrs.web.controller.PseudoStaticContentController" />
	            <bean class="org.openmrs.web.dwr.DWRPatientService" />
	            <bean class="org.openmrs.web.WebUtil" />
	        </list>
	    </property>
	</bean>
	
	<!-- Find/replace strings after errant 'contrl-shift-f':
		>\r\n			<value>(.*)</value>\r\n		</property>
		><value>$1</value></property>
	-->
</beans>
